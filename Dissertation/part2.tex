\chapter{Решение обратной задачи в пространстве матриц кросс-спектральной плотности} \label{chapt2}

% План.
% Методы решения обратной задачи для МЭГ/ЭЭГ.
% Сканирующий подход. Нахождение ориентации диполя.
% MUSIC, RAP-MUSIC, бимформеры. Сканирующие методы решения обратной задачи для анализа коннективностей.
% Алгоритм DICS. Модификация DICS для оценки imcoh в пр-ве источников. Wedge MUSIC.
% Методы глолбальной оптимизации.
% Оценка активностей при помощи псевдообратной матрицы.
% Априорная информация о структуре решения. MNE, MinimumCurrent, mxNormMNE.
% Адаптация MxNormMNE к решению обратной задачи для поиска синхронностей.
% Техники ускорения расчета и оптимизации вычислительных ресурсов.
% Active set и связь с MUSIC.
% Критерий останова алгоритма.
% Сокращение размерности пр-ва сенсоров.

\section{Введение}

В предыдущей главе нами была получена система уравнений, связывающая коэффициенты матрицы
кросс-спектральной плотности мощности в пространстве источников с аналогичными коэффициентами в
пространстве сенсоров. Хотя это уравнение и является линейными относительно неизвестных
величин $c_{ij}^{ss}$, процедура нахождения решения, которое адекватно описывало бы
поведение реальных систем, осложнено тем фактом, что рассматриваемая система уравнений
существенно недоопределена, а следовательно для нее существует бесконечное количество решений,
далеко не все из которых осуществимы для реальных систем взаимодействующих нейронных ансамблей.

Вообще, система уравнений \ref{eq:cp_final_re_im} для фиксированных ориентаций диполей
по своей структуре ничем кроме шумового слагаемого не отличается от систем \ref{eq:BV_generative_matrix}.
Системы уравнений \ref{eq:BV_generative_matrix} на неизвестные величины $\mathcal{Q}$ также является
линейным и недоопределенными. Некоторые отличия возникают лишь при рассмотрении свободно ориентированных диполей.

Задачу оценки величин, положений и ориентаций токовых диполей $\mathcal{Q}$
на основании измерений $\mathcal{B}, \mathcal{V}$ в электрофизиологии принятно называть \emph{обратной задачей} МЭГ/ЭЭГ.
Как и в случае оценки кросс-спектральных коэффициентов, решение обратной задачи МЭГ/ЭЭГ не единственно.
Для выбора какого-либо одного решения $\mathcal{Q}$ по коре применяют различные эвристики,
ограничивающие выбор из бесконечного множества возможных вариантов.
Как правило, получающееся решение отвечает тому или иному критерию оптимальности в соответствии с используемой эвристикой,
при условии, что предположения модели выполняются.
Во введении к этой главе мы рассмотрим основные методы решения обратной задачи для поиска
активных токовых диполей на коре, а затем перейдем к рассмотрению методик для оценки
кросс-спектральных коэффициентов с учетом свободной ориентации.

Все существующие методики решения обратной задачи МЭГ/ЭЭГ можно условно разделить на два класса.
К первому классу относятся алгоритмы, основанные на методах оптимальной фильтрации.
Суть этого подхода состоит в том, что для фиксированной точки внутри объема мозга ставится задача нахождения
пространственного фильтра, оптимизирующего определенную характеристику сигнала,
восстанавливаемого при помози этого фильтра.
В качестве такой характеристики может выступать, например, отношение сигнал/шум,
или же мы можем руководствоваться критерием минимизации протечки сигнала от других источников в точку,
в которой мы хотим восстановить активность.
Здесь важно отметить, что конкретный вид решения, полученного в результате оптимизации выбранного
функционала качества будет зависить также от предполагаемой пространственной структуры шума.

Отметим, что структура восстановленной после применения совокупности найденных фильтров
активации на коре при таком подходе, вообще говоря, субоптимальна с точки зрения объяснения сигнала,
измеренного сенсорами (так как мы оптимизировали другой функционал качества).
Проблема недоопределенности системы уравнений при этом в некотором смысле остается за скобками,
так как для каждой точки коры решение восстанавливается индивидуально ---
без учета вклада в решение активаций, восстановленных в других точках коры.
Таким образом, для первого класса алгоритмов решения обратной задачи найденное решение
является оптимальным в локальном, но не в глобальном смысле.

Задача отыскания активаций, наилучшим образом объясняющих измерения, (т.е. оптимальных в глобальном смысле)
ставится для вторго класса алгоритмов решения обратной задачи.
При этом, как уже было отмечено выше, в силу недоопределенности системы линейных уравнений,
связывающих активации на коре с сигналом на сенсорах, существует бесконечное множество
конфигураций источников, идеально объясняющих померенный сигнал.
Тем не менее, среди таких решений в силу зашумленности измерений а также неточностей
при построении прямой модели реальное распределение активаций в выделенных точках коры
не содержится, так эти <<идеальные>> с точки зрения объяснения измерений решения объясняют в том числе и
шумовую компоненту, которая зачастую оказывается больше или сравнима по амплитуде с истинной активацией.

Итак, при решении обратной задачи методами глобальной оптимизации существует две проблемы:
бесконечное множество возможных решений и зашумленность измерений. Чтобы справиться с первой проблемой,
для выбора из бесконечного множества решений пользуются критерием минимальности нормы решения.
Иными словами, среди всех возможных конфигураций первичных токов в объеме (или на поверхности коры) мозга
в качестве решения выбирается такая конфигурация, норма которой минимальна среди всех возможных.
Выбор нормы при этом определяет структуру решения.
Наиболее популярными вариантами являются $L_2$- и $L_1$-нормы.
В случае, если проблему зашумленности данных мы оставляем без внимания, решение, соответствующее
минимуму $L_2$-нормы, получается применением оператора,
соответствующего псевдообратной матрице матрицы прямой модели.



\subsection{Сканирующие алгоритмы} \label{sect_dics}
Сущестувует множество различных подходов к решению обратной задачи МЭГ/ЭЭГ, основанных
на принципиально различных идеях.
Тем не менее, задача каждой из возможных методик состоит в отыскании
линейного обратного оператора, подействовав которым на вектор значений сигнала на сенсорах
в какой-либо момент времени мы получим распределение активности по всей коре или в какой-то ее части.
При этом, полученное решение должно отвечать критерию оптимальности в том или ином смысле.

Мы начнем рассмотрение существующих методик решения обратной задачи с класса алгоритмов, которые
можно условно назвать \emph{сканирующими}. Смысл названия кроется в том,
