\input{Dissertation/appendixsetup}   % Предварительные настройки для правильного подключения Приложений
\chapter{Реализация алгоритма RAP-MUSIC на языке Python}\label{appendix:rap_music_code}

\begin{ListingEnv}[!h]
    \begin{lstlisting}[language=Python,label={rap_music_listing},caption={Алгоритм RAP-MUSIC}]
def RAP_MUSIC(X, G, threshold):
    """
    Параметры
    ---------
    X : матрица измерений
    G : матрица прямой модели для свободной ориентации
    threshold : порог корреляции подпространств

    Возвращает
    ----------
    active_dipole_indices : индексы найденных диполей

    """
    # инициализируем пустой список индексов активных диполей
    active_dipole_indices = []

    while True:
        # ищем корреляции подпространств для каждого источника
        C = MUSIC_scan(X, G)
        if max(C) < threshold:
            break
        k = argmax(C)
        active_dipole_indices.append(k) 
        # проецируем от диполей k-го источника
        X, G = project_away_from_k(X, G, k) 

    return active_dipole_indices
    \end{lstlisting}
\end{ListingEnv}

\chapter{Распределение индуцированной активности по коре в реальных данных}\label{appendix:real_data_power}
